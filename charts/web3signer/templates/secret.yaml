apiVersion: v1
kind: Secret
metadata:
  name: keystores
type: Opaque
data:
{{- range $path, $bytes := .Files.Glob "keys/*.json"}}
{{ regexReplaceAll "(.*)/" $path "" | indent 2 }}: '{{ $bytes | toString | b64enc }}'
{{- end }}

---
apiVersion: v1
kind: Secret
metadata:
  name: keystore-passwords
type: Opaque
data:
  keystore1.pass: {{ .Files.Get "keys/keystore1.pass" | b64enc }}
  keystore2.pass: {{ .Files.Get "keys/keystore2.pass" | b64enc }}
  keystores.pass: {{ .Files.Get "keys/keystores.pass"  | b64enc }}
---
apiVersion: v1
kind: Secret
metadata:
  name: keystore-files
type: Opaque
data:
  keystore1.yaml: {{ .Files.Get "keys/validator1.yaml" | b64enc }}
  keystore2.yaml: {{ .Files.Get "keys/validator2.yaml" | b64enc }}
